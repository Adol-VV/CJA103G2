<h3 class="mb-4">我的商品訂單</h3>

<!-- Order Status Tabs -->
<ul class="nav nav-tabs mb-4 border-secondary">
    <li class="nav-item">
        <a class="nav-link active bg-transparent text-white border-bottom border-success border-0 border-bottom-2"
            data-bs-toggle="tab" href="#ordersAll">全部訂單</a>
    </li>
    <!--<li class="nav-item">
        <a class="nav-link bg-transparent text-muted border-0" data-bs-toggle="tab" href="#ordersPending">
            待出貨 <span class="badge bg-warning ms-2 rounded-pill" id="pendingOrderCount">1</span>
        </a>
    </li>
    <li class="nav-item"><a class="nav-link bg-transparent text-muted border-0" data-bs-toggle="tab"
            href="#ordersShipped">已出貨</a></li>
    <li class="nav-item"><a class="nav-link bg-transparent text-muted border-0" data-bs-toggle="tab"
            href="#ordersCompleted">已完成</a></li>
    <li class="nav-item"><a class="nav-link bg-transparent text-muted border-0" data-bs-toggle="tab"
            href="#ordersRefunded">退款/退貨</a></li>-->
</ul>

<div class="tab-content">
    <!-- All Orders -->
    <div class="tab-pane fade show active" id="ordersAll">
        <!-- <div class="row g-3 mb-3">
            <div class="col-md-6"><input type="text" class="form-control bg-dark text-white border-secondary"
                    id="searchProductOrder" placeholder="搜尋訂單編號或商品名稱"></div>
            <div class="col-md-3">
                <select class="form-select bg-dark text-white border-secondary" id="filterOrderDate">
                    <option value="">全部時間</option>
                    <option value="30d">近 30 天</option>
                </select>
            </div>
            <div class="col-md-3">
                <select class="form-select bg-dark text-white border-secondary" id="filterOrderStatus">
                    <option value="">全部狀態</option>
                    <option value="pending">待付款</option>
                    <option value="shipped">已出貨</option>
                </select>
            </div>
        </div> -->

        <div id="productOrdersList">
            <!-- Mock Order Card 1 -->
            <div class="card mb-3 order-card bg-dark border-secondary" th:each="order:${allProdOrder}">
                <div class="card-header border-secondary d-flex justify-content-between align-items-center">
                    <div>
                        <span class="text-muted small">訂單編號：</span><strong
                            class="text-white" th:text="${order.orderId}">#ORD-PROD-20241120-001</strong>
                        <span class="ms-3 text-muted small">下單時間：</span><span class="text-white small" th:text="${#dates.format(order.createdDate, 'yyyy/MM/dd HH:mm')}">2024/11/20
                            14:30</span>
                    </div>
                    <td>
                        <div th:switch="${order.status}">
                            <span th:case="0" class="badge bg-secondary">未付款</span>
                            <span th:case="1" class="badge bg-primary">已付款</span>
                            <span th:case="2" class="badge bg-success">已到貨</span>
                            <span th:case="3" class="badge bg-danger">退貨</span>
                            <span th:case="*" class="badge bg-light text-dark">未知狀態</span>
                        </div>
                    </td>
                </div>
                <div class="card-body">
                    <div class="order-item mb-3" th:each="item:${order.orderItems}">
                        <div class="row align-items-center">
                            <div class="col-auto"><img loading="lazy" th:src="${item.prodId.prodImages[0].imageUrl}"
                                    class="rounded"></div>
                            <div class="col">
                                <h6 class="mb-1 text-white" th:text="${item.prodId.prodName}">2024年度音樂會紀念T恤</h6>
                                <!-- <p class="text-muted small mb-1" th>尺寸：L / 顏色：黑色</p> -->
                                <p class="mb-0 text-white">
                                    <span class="text-muted" th:text="'NT$'+${item.prodId.prodPrice}">NT$ 880</span>
                                    x<span th:text="${item.quantity}">1</span>
                                </p>
                            </div>
                            <div class="col-auto text-end"><strong class="text-white" th:text="'NT$'+${item.total}">NT$
                                    880</strong></div>
                        </div>
                    </div>
                    <hr class="border-secondary">
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="text-white small">
                            <div class="mb-1"><strong>收件人：</strong><span th:text="${session.loginMember.name}">王小明</span> (<span th:text="${session.loginMember.phone}">0912-345-678</span>)</div>
                            <div><strong>地址：</strong><span th:text="${session.loginMember.address}">台北市信義區信義路五段7號</span></div>
                        </div>
                        <div class="text-end">
                            <div class="text-muted small">訂單總額</div>
                            <strong class="text-primary fs-5" th:text="'NT$'+${order.total}">NT$ 1,390</strong>
                        </div>
                    </div>
                </div>
                <div class="card-footer border-secondary d-flex justify-content-between">
                    <div>
                         <form th:action="@{/member/prod_order/orderDetail}" method="post" style="display:inline;">
                        <input type="hidden" name="orderId" th:value="${order.orderId}" />
                        
                        <button type="submit" class="btn btn-outline-primary btn-sm btn-view-order-detail">
                            詳情
                        </button>
                        </form>
                        <!--<button class="btn btn-outline-secondary btn-sm"><i class="fas fa-headset"></i> 客服</button>-->
                    </div>
                    <form th:action="@{/member/prod_order/deleteOrder}" method="post" style="display:inline;">
                        <input type="hidden" name="orderId" th:value="${order.orderId}" />
                        
                        <button type="submit" class="btn btn-outline-danger btn-sm"
                                onclick="return confirm('確定要取消這筆訂單嗎？');">
                            取消訂單
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Pagination -->
        <nav class="mt-4">
            <ul class="pagination justify-content-center pagination-sm">
                <li class="page-item active"><a class="page-link" href="#">1</a></li>
            </ul>
        </nav>
    </div>

    <!-- Other tabs placeholders (simplified) -->
    <div class="tab-pane fade" id="ordersPending">
        <div class="alert alert-info bg-dark border-secondary text-white">載入待出貨訂單...</div>
    </div>
    <div class="tab-pane fade" id="ordersShipped">
        <div class="alert alert-info bg-dark border-secondary text-white">載入已出貨訂單...</div>
    </div>
    <div class="tab-pane fade" id="ordersCompleted">
        <div class="alert alert-info bg-dark border-secondary text-white">載入已完成訂單...</div>
    </div>
    <div class="tab-pane fade" id="ordersRefunded">
        <div class="alert alert-info bg-dark border-secondary text-white">載入退款訂單...</div>
    </div>
</div>